#--------------------------------------------------------------------------------------------------#
#
#   C3 and C4 model representations of photosynthesis.  Used for fitting and deriving
#   key photosynthetic parameters
#
#--------------------------------------------------------------------------------------------------#

# ============================================== C3 ================================================ 

#--------------------------------------------------------------------------------------------------#
##' 
##' Farquhar functions
##' 
##' @author Shawn P. Serbin
##' 
# Rd and Vcmax only
ACi.rubisco <- function(x) {
  keep <- which(Ci<Vcmax.cutoff)
  Vcmax <- x[1]  ## Vcmax param
  Rd    <- x[2]  ## Resp param
  
  Ac    <- (Vcmax*(Ci[keep]-Gstar[keep]))/(Ci[keep]+Km[keep])
  Assim <- pmin(Ac)-Rd
  RMSE <- sqrt(mean((Photo[keep]-Assim)^2))  ## RMSE cost function
  return(RMSE)
}
#==================================================================================================#


#--------------------------------------------------------------------------------------------------#
# Rd and Jmax only
ACi.rubp  <- function(x) {
  keep <- which(Ci>Jmax.cutoff)
  Jmax <- x[1]  ## Jmax param
  Rd   <- x[2]  ## Resp param
  
  Aj    <- Jmax*(Ci[keep]-Gstar[keep])/((4.5*Ci[keep])+(10.5*Gstar[keep]))
  Assim <- pmin(Aj)-Rd
  RMSE <- sqrt(mean((Photo[keep]-Assim)^2))  ## RMSE cost function
  return(RMSE)
}
#==================================================================================================#


# ============================================== C4 ================================================ 


#--------------------------------------------------------------------------------------------------#
##' 
#==================================================================================================#


####################################################################################################
### EOF.  End of R script file.              
####################################################################################################